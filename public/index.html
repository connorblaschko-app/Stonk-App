<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stonk App</title>
    <link rel="stylesheet" href="/style.css" />
    <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <main>
      <h1>Stonk App</h1>
      <p class="subtitle">Unified investment tracker with Plaid sync + manual holdings + Google Sheets export.</p>

      <section class="quick-start card">
        <h2>No-coding workflow</h2>
        <ol>
          <li>Click <strong>Connect Plaid</strong> to link your brokerage account.</li>
          <li>Click <strong>Sync Plaid Holdings</strong> whenever you want fresh balances.</li>
          <li>Add non-broker investments with the manual form or bulk import CSV.</li>
          <li>Click <strong>Sync to Google Sheets</strong> to push everything back to your sheet.</li>
        </ol>
      </section>

      <section class="controls">
        <button id="connectPlaidBtn">Connect Plaid</button>
        <button id="syncPlaidBtn">Sync Plaid Holdings</button>
        <button id="syncSheetsBtn">Sync to Google Sheets</button>
      </section>

      <section class="cards">
        <article class="card">
          <h2>Total Portfolio Value</h2>
          <p id="totalValue">$0.00</p>
          <small id="lastSync">Plaid sync: never</small>
        </article>
        <article class="card">
          <h2>Status</h2>
          <p id="statusText">Ready.</p>
        </article>
      </section>

      <section class="layout">
        <article>
          <h2>Add Manual Investment</h2>
          <form id="manualForm">
            <input name="account" placeholder="Account (e.g. 401k)" required />
            <input name="symbol" placeholder="Symbol" required />
            <input name="name" placeholder="Investment name" required />
            <input name="quantity" type="number" step="0.0001" min="0" placeholder="Quantity" required />
            <input name="price" type="number" step="0.01" min="0" placeholder="Price" required />
            <input name="costBasis" type="number" step="0.01" min="0" placeholder="Cost Basis" />
            <button type="submit">Add</button>
          </form>

          <h3>Bulk import manual investments</h3>
          <p class="help-text">Upload a CSV with columns: <code>account,symbol,name,quantity,price,costBasis</code>.</p>
          <div class="import-row">
            <input id="manualCsvFile" type="file" accept=".csv,text/csv" />
            <button id="importCsvBtn" type="button">Import CSV</button>
          </div>
        </article>

        <article>
          <h2>Breakdown by Source</h2>
          <canvas id="sourceChart"></canvas>
        </article>
      </section>

      <section>
        <h2>All Positions</h2>
        <table>
          <thead>
            <tr>
              <th>Source</th>
              <th>Account</th>
              <th>Symbol</th>
              <th>Name</th>
              <th>Quantity</th>
              <th>Price</th>
              <th>Value</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="positionsTable"></tbody>
        </table>
      </section>
    </main>
    <script src="/app.js"></script>
  </body>
</html>
